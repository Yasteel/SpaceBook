@model Post

<link rel="stylesheet" type="text/css" href="~/css/main.css">

<div class="modal fade" id="uploadMediaModal" tabindex="-1" role="dialog" aria-labelledby="uploadMediaModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Create new post</h5>
                <button id="closeModal" type="button" data-bs-dismiss="modal">
                    <span class="close" aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="form" method="post" asp-action="Index" asp-controller="Create" enctype="multipart/form-data">
                    <div class="col" id="drop_zone" ondrop="dropHandler(event);" ondragover="dragOverHandler(event);">
                        <p>Drag one or more files to this <i>drop zone</i>.</p>
                        <input id="upload" type="file" name="Media" onchange="handleImageUpload()" />
                    </div>
                    <div class="col">
                        <label asp-for="Caption"></label>
                        <input type="text" asp-for="Caption" />
                        <div class="dx-field-value">
                            @(Html.DevExtreme().TagBox()
                                .ID("ShareTagBox")
                                .DataSource(d => d.Mvc().Controller("ProfileApi").LoadAction("Get").Key("UserId"))
                                .DisplayExpr("Username")
                                .ValueExpr("UserId")
                                .Placeholder("Choose people to share with...")
                                .OnSelectionChanged("update_hidden_field")
                                )
                        </div>
                    </div>
                   
                    <img id="display-image" src="" />
                    <button type="submit">Share</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>


    function handleImageUpload() {
        var image = document.getElementById("upload").files[0];
        var reader = new FileReader();

        reader.onload = function (e) {
            document.getElementById("display-image").src = e.target.result;
        }

        reader.readAsDataURL(image);
    }

    function update_hidden_field(args) {
        $("#ProfileIDs").val($("#ShareTagBox").dxTagBox("option", "selectedItems"));

    }

</script>

